function levelToBatch(t){var e,a,s=(new Date).getFullYear();switch(a=2017==s?s+1:s+1+" & "+s,t){case"seven":e=s+5;break;case"eight":e=s+4;break;case"nine":e=s+3;break;case"ten":e=s+2;break;case"tweleven":e=a}return e}function redraw(t){$("input").each(function(){$(this).detach()}),$("#g").attr("class","").text("Welcome");for(var e=1;e<4;e++)$("#pane-"+e).remove(),$("#app .row").append($("<div></div>").addClass("col-lg-4").attr("id","pane-"+e));for(var a=0,s=function(e){var s=e<4?1:e<8?2:3,i=$("<div></div>").addClass("subject"),n=$("<span></span>"),c=$("<input>").attr("type","number").attr("data-subject",e);null!=t&&$(c).val(t[e]),$(n).text(grade.default[e].subject),$(i).append(n).append(c),$("#pane-"+s).append(i),a++},i=0;i<4;i++)s(i);for(var i=4;i<grade.default.length;i++)s(i);if(grade.default.length>8)for(var i=a;i<grade.default.length;i++)s(i);else $("#pane-3").remove(),$("#pane-1").addClass("col-lg-offset-2");$("input").on("change paste keyup input",function(t){if($(this).val().length>4){var e=$(this).val().slice(0,4);$(this).val(e)}state.change(this)}),null!=t&&calculate()}function hopToNext(t){var e=$(t).val();if(4==e.length&&!isInvalidGrade(parseFloat(e))){var a=$("input"),s=parseInt($(a[a.length-1]).attr("data-subject")),i=parseInt($(t).attr("data-subject"));i!=s&&($(t).blur(),$("input[data-subject="+(i+1)+"]").focus())}}function isInvalidGrade(t){var e=parseFloat(t),a=!1;return/[^0-9\.]+/.test(t)?a=!0:e<1||e>5?a=!0:e<3&&e%.25!=0?a=!0:(e>3&&e<4||e>4&&e<5)&&(a=!0),a}function convertToGpa(t,e){var a;return a=1==t?4:1.25==t?3.7:1.5==t?3.3:1.75==t?3:2==t?2.7:2.25==t?2.3:2.5==t?2:2.75==t?1.7:3==t?1.3:4==t?1:0,a*e}function calculate(){var t,e=0,a=0,s=0;if(state.current.isGpa?$("input").each(function(){var t=$(this).val();if(!t)return e=1,!1;if(isInvalidGrade(t))return e=2,!1;var i=$(this).attr("data-subject"),n=grade.default[i].units;s+=n,a+=convertToGpa(t,n)}):$("input").each(function(){var t=$(this).val();if(!t)return e=1,!1;if(isInvalidGrade(t))return e=2,!1;var i=$(this).attr("data-subject");a+=parseFloat(t)*grade.default[i].units,s+=grade.default[i].units}),t=a/s,1==e)$("#g").attr("class","").text("Welcome");else if(2==e)$("#g").attr("class","err").text("Error");else{var i=t.toPrecision(10)+"";$("#g").removeAttr("class").text(i.slice(0,5)),t<=1.5&&0!=t&&$("#g").addClass("dl")}}$(document).ready(function(){grade.default=grade.seven,state.load(),$("li").each(function(t){$(this).click(function(t){var e=$(this).children();t.preventDefault(),state.update($(e).attr("data-item"),null)});var e=levelToBatch($(this).children().attr("data-item"));$(this).children().text("Batch "+e)}),$("#c_nm").click(function(){var t=!$("html").hasClass("night");return state.current.isNightMode=t,state.save(),t?$("#c_nm span").text("day mode"):$("#c_nm span").text("night mode"),t?$("html").addClass("night"):$("html").removeAttr("class")}),$("#c_cm").click(function(){var t=!state.current.isGpa;return state.current.isGpa=t,state.save(),t?$("#c_cm span").text("gwa mode"):$("#c_cm span").text("cgpa mode (beta)"),calculate()}),$("#hamburger").click(function(){$(this).hasClass("active")?($(this).removeAttr("class"),$("#menu .menu-content").addClass("invis")):($(this).addClass("active"),$("#menu .menu-content").removeClass("invis"))}),$("#refresh").click(redraw)});var state={current:{set:null,grades:[],isNightMode:!1,isGpa:!1},update:function(t,e){if(grade[t]){var a=levelToBatch(t);if($("#btn-text").text(a),grade.default=grade[t],grade.set=t,this.current.set=t,null==e){this.current.grades=[];for(var s=0;s<grade.default.length;s++)this.current.grades.push("");this.save(),redraw(this.current.grades)}else redraw(e)}else console.error('Invalid gradeset "'+t+'"')},change:function(t){var e=$(t).attr("data-subject"),a=$(t).val();this.current.grades[e]=a,this.save(),calculate()},load:function(){if(void 0!==typeof Storage){var t=localStorage.getItem("gwadata");if(null!=t){var e=JSON.parse(t),a=e.isNightMode,s=e.isGpa,i=e.set,n=e.grades;this.current=e,this.update(i,n),a&&($("html").addClass("night"),$("#c_nm span").text("day mode")),s&&$("#c_cm span").text("gwa mode")}else redraw()}},save:function(){if(void 0!==typeof Storage){var t=this.current,e=JSON.stringify(t);localStorage.setItem("gwadata",e)}}},grade={seven:[{subject:"Integrated Science",units:1.7},{subject:"Mathematics",units:1.7},{subject:"English",units:1.3},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Values Education",units:.7},{subject:"AdTech",units:1},{subject:"Computer Science",units:1}],eight:[{subject:"Integrated Science",units:2},{subject:"Mathematics",units:1.7},{subject:"English",units:1.3},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Values Education",units:.7},{subject:"AdTech",units:1},{subject:"Computer Science",units:1},{subject:"Earth Science",units:.7}],nine:[{subject:"Biology",units:1},{subject:"Chemistry",units:1},{subject:"Physics",units:1},{subject:"Mathematics",units:1},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Statistics",units:1},{subject:"Computer Science",units:1},{subject:"Earth Science",units:.7}],ten:[{subject:"Biology",units:1},{subject:"Chemistry",units:1},{subject:"Physics",units:1},{subject:"Mathematics",units:1.3},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"STR",units:1},{subject:"Computer Science",units:1},{subject:"Elective",units:1}],tweleven:[{subject:"Science",units:1.7},{subject:"Mathematics",units:1},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"STR",units:2},{subject:"Additional Science",units:1.7}]};