function levelToBatch(t){var e,s,a=(new Date).getFullYear();switch(s=2017==a?a+1:a+1+" & "+a,t){case"seven":e=a+5;break;case"eight":e=a+4;break;case"nine":e=a+3;break;case"ten":e=a+2;break;case"tweleven":e=s}return e}function redraw(t){$("input, .lock").each(function(){$(this).remove()}),$("#g").attr("class","").text("Welcome");for(var e=1;e<4;e++)$("#pane-"+e).remove(),$("#app .row").append($("<div></div>").addClass("col-lg-4").attr("id","pane-"+e));for(var s=0,a=function(e){var a="undefined"!=typeof state.current.lock&&state.current.lock[e],n=a===!0?"img/locked.min.svg":"img/unlocked.min.svg",i=e<4?1:e<8?2:3,c=$("<div></div>").addClass("subject"),r=$("<span></span>"),u=$("<img>").addClass("lock").attr("src",n),l=($("<img>").attr("src","img/settings.min.svg"),$("<div></div>").addClass("grade-control").append(u)),d=$("<input>").attr("type","number").attr("data-subject",e);a===!0&&$(d).attr("disabled","disabled"),null!=t&&$(d).val(t[e]),$(r).text(grade.default[e].subject),$(c).append(r).append(l).append(d),$("#pane-"+i).append(c),s++},n=0;n<4;n++)a(n);for(var n=4;n<grade.default.length;n++)a(n);if(grade.default.length>8)for(var n=s;n<grade.default.length;n++)a(n);else $("#pane-3").remove(),$("#pane-1").addClass("col-lg-offset-2");var i=$("input");$(i).each(function(){$(this).on("change paste keyup input",function(t){if($(this).val().length>4){var e=$(this).val().slice(0,4);$(this).val(e)}state.change(this)})}),null!=t&&calculate(),$(".lock").each(function(){$(this).click(function(){var t=$(this).closest(".subject").children("input"),e=!$(t)[0].hasAttribute("disabled");e?($(t).attr("disabled","disabled"),$(this).attr("src","img/locked.min.svg")):($(t).removeAttr("disabled"),$(this).attr("src","img/unlocked.min.svg")),state.toggle(t,e)})})}function hopToNext(t){var e=$(t).val();if(4==e.length&&!isInvalidGrade(parseFloat(e))){var s=$("input"),a=parseInt($(s[s.length-1]).attr("data-subject")),n=parseInt($(t).attr("data-subject"));n!=a&&($(t).blur(),$("input[data-subject="+(n+1)+"]").focus())}}function isInvalidGrade(t){var e=parseFloat(t),s=!1;return/[^0-9\.]+/.test(t)?s=!0:e<1||e>5?s=!0:e<3&&e%.25!=0?s=!0:(e>3&&e<4||e>4&&e<5)&&(s=!0),s}function convertToGpa(t,e){var s;return s=1==t?4:1.25==t?3.7:1.5==t?3.3:1.75==t?3:2==t?2.7:2.25==t?2.3:2.5==t?2:2.75==t?1.7:3==t?1.3:4==t?1:0,s*e}function calculate(){var t,e=0,s=0,a=0;if(state.current.isGpa?$("input").each(function(){var t=$(this).val();if(!t)return e=0,!0;if(isInvalidGrade(t))return e=1,!1;e=2;var n=$(this).attr("data-subject"),i=grade.default[n].units;a+=i,s+=convertToGpa(t,i)}):$("input").each(function(){var t=$(this).val();if(!t)return e=0,!0;if(isInvalidGrade(t))return e=1,!1;e=2;var n=$(this).attr("data-subject");s+=parseFloat(t)*grade.default[n].units,a+=grade.default[n].units}),t=s/a,0==e)$("#g").attr("class","").text("Welcome");else if(1==e)$("#g").attr("class","err").text("Error");else{var n=t.toPrecision(10)+"";$("#g").removeAttr("class").text(n.slice(0,5)),t<=1.5&&0!=t&&$("#g").addClass("dl")}}$(document).ready(function(){grade.default=grade.seven,state.load(),$("li").each(function(t){$(this).click(function(t){var e=$(this).children();t.preventDefault(),state.update($(e).attr("data-item"),null)});var e=levelToBatch($(this).children().attr("data-item"));$(this).children().text("Batch "+e)}),$("#c_nm").click(function(){$("#hamburger").removeAttr("class"),$("#menu .menu-content").addClass("invis");var t=!$("html").hasClass("night");return state.current.isNightMode=t,state.save(),t?$("#c_nm span").text("day mode"):$("#c_nm span").text("night mode"),t?$("html").addClass("night"):$("html").removeAttr("class")}),$("#c_cm").click(function(){$("#hamburger").removeAttr("class"),$("#menu .menu-content").addClass("invis");var t=!state.current.isGpa;return state.current.isGpa=t,state.save(),t?$("#c_cm span").text("gwa mode"):$("#c_cm span").text("cgpa mode (beta)"),calculate()}),$("#hamburger").click(function(){$(this).hasClass("active")?($(this).removeAttr("class"),$("#menu .menu-content").addClass("invis")):($(this).addClass("active"),$("#menu .menu-content").removeClass("invis"),window.setTimeout(function(){$(document).one("click",function(t){$(t.target).closest(".menu-content").length||($("#hamburger").removeAttr("class"),$("#menu .menu-content").addClass("invis"))})},500))}),$("#refresh").click(function(){state.current.grades=[],state.current.lock=[],state.save(),redraw()})});var state={current:{set:null,grades:[],lock:[],isNightMode:!1,isGpa:!1},update:function(t,e){if(grade[t]){var s=levelToBatch(t);if($("#btn-text").text(s),grade.default=grade[t],grade.set=t,this.current.set=t,null==e){this.current.grades=[];for(var a=0;a<grade.default.length;a++)this.current.grades.push("");this.save(),redraw(this.current.grades)}else redraw(e)}else console.error('Invalid gradeset "'+t+'"')},change:function(t){for(var e=parseInt($(t).attr("data-subject")),s=$(t).val(),a=0;a<grade.default.length;a++)a!=e?"undefined"==typeof this.current.grades[a]&&this.current.lock.push(""):this.current.grades[e]=s;this.save(),calculate()},toggle:function(t,e){for(var s=parseInt($(t).attr("data-subject")),a=0;a<grade.default.length;a++)a!=s?"undefined"==typeof this.current.lock[a]&&this.current.lock.push(!1):this.current.lock[a]=e;this.save()},load:function(){if(void 0!==typeof Storage){var t=localStorage.getItem("gwadata");if(null!=t){var e=JSON.parse(t),s=e.isNightMode,a=e.isGpa,n=e.set,i=e.grades;this.current=e,this.update(n,i),s&&($("html").addClass("night"),$("#c_nm span").text("day mode")),a&&$("#c_cm span").text("gwa mode"),"undefined"==typeof this.current.lock&&(this.current.lock=[],this.save())}else redraw()}},save:function(){if(void 0!==typeof Storage){var t=this.current,e=JSON.stringify(t);localStorage.setItem("gwadata",e)}}},grade={seven:[{subject:"Integrated Science",units:1.7},{subject:"Mathematics",units:1.7},{subject:"Computer Science",units:1},{subject:"English",units:1.3},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Values Education",units:.7},{subject:"AdTech",units:1}],eight:[{subject:"Integrated Science",units:2},{subject:"Mathematics",units:1.7},{subject:"Computer Science",units:1},{subject:"English",units:1.3},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Values Education",units:.7},{subject:"AdTech",units:1},{subject:"Earth Science",units:.7}],nine:[{subject:"Biology",units:1},{subject:"Chemistry",units:1},{subject:"Physics",units:1},{subject:"Mathematics",units:1},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"Statistics",units:1},{subject:"Computer Science",units:1},{subject:"Earth Science",units:.7}],ten:[{subject:"Biology",units:1},{subject:"Chemistry",units:1},{subject:"Physics",units:1},{subject:"Mathematics",units:1.3},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"PEHM",units:1},{subject:"STR",units:1},{subject:"Computer Science",units:1},{subject:"Elective",units:1}],tweleven:[{subject:"Science",units:1.7},{subject:"Mathematics",units:1},{subject:"English",units:1},{subject:"Filipino",units:1},{subject:"Social Science",units:1},{subject:"STR",units:2},{subject:"Additional Science",units:1.7}]};